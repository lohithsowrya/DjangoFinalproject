{% extends "base.html" %}
{% block content %}

<style>
  .cart-container {
    max-width: 900px;
    margin: auto;
    background: #fff;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .cart-container h2 {
    margin-bottom: 20px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    padding: 12px;
    text-align: center;
  }

  th {
    background: #f1f1f1;
  }

  tr:nth-child(even) {
    background: #fafafa;
  }

  .qty-form {
    display: flex;
    justify-content: center;
    gap: 5px;
  }

  .qty-form input {
    width: 60px;
    padding: 5px;
    text-align: center;
  }

  .btn-update {
    padding: 5px 10px;
    border: none;
    background: #17a2b8;
    color: white;
    border-radius: 4px;
    cursor: pointer;
  }

  .btn-update:hover {
    background: #117a8b;
  }

  .btn-remove {
    color: red;
    text-decoration: none;
    font-weight: 500;
  }

  .btn-remove:hover {
    text-decoration: underline;
  }

  .total {
    text-align: right;
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
  }

  .checkout-btn {
    margin-top: 20px;
    padding: 10px 18px;
    background: #28a745;
    color: white;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    font-size: 16px;
  }

  .checkout-btn:hover {
    background: #218838;
  }

  .empty-cart {
    text-align: center;
    font-size: 18px;
    color: #666;
  }

  @media (max-width: 768px) {
    table, thead, tbody, th, td, tr {
      display: block;
    }

    tr {
      margin-bottom: 15px;
      border-bottom: 1px solid #ddd;
    }

    th {
      display: none;
    }

    td {
      text-align: right;
      position: relative;
      padding-left: 50%;
    }

    td::before {
      position: absolute;
      left: 10px;
      width: 45%;
      white-space: nowrap;
      font-weight: bold;
    }

    td:nth-of-type(1)::before { content: "Product"; }
    td:nth-of-type(2)::before { content: "Price"; }
    td:nth-of-type(3)::before { content: "Qty"; }
    td:nth-of-type(4)::before { content: "Subtotal"; }
    td:nth-of-type(5)::before { content: "Action"; }
  }
  .product-cell {
  display: flex;
  align-items: center;
  gap: 10px;
}

.cart-img {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 6px;
  border: 1px solid #ddd;
}

</style>

<div class="cart-container">
  <h2>My Cart</h2>

  {% if items %}
  <table>
      <tr>
          <th>Product</th>
          <th>Price</th>
          <th>Qty</th>
          <th>Subtotal</th>
          <th>Action</th>
      </tr>

      {% for item in items %}
      <tr>
        <td class="product-cell">
            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="cart-img">
            <span>{{ item.product.name }}</span>
        </td>
          <td>₹ {{ item.product.price }}</td>
          <td>
              <form method="POST" action="{% url 'update_cart' item.product.id %}" class="qty-form">
                  {% csrf_token %}
                  <input type="number" name="quantity" value="{{ item.qty }}" min="1">
                  <button type="submit" class="btn-update">Update</button>
              </form>
          </td>
          <td>₹ {{ item.subtotal }}</td>
          <td>
              <a href="{% url 'remove_from_cart' item.product.id %}" class="btn-remove">
                  Remove
              </a>
          </td>
      </tr>
      {% endfor %}
  </table>

  <div class="total">
    Total: ₹ {{ total }}
  </div>

  <form method="POST" action="{% url 'place_order' %}">
      {% csrf_token %}
      <button type="submit" class="checkout-btn">
        Proceed to Checkout
      </button>
  </form>

  {% else %}
    <p class="empty-cart">Your cart is empty.</p>
  {% endif %}
</div>

{% endblock %}
